<?xml version="1.0" encoding="utf-8"?>
<odoo>
    
    <!-- Override certification report -->
    <template id="certification_report_view_general_custom" inherit_id="survey.certification_report_view_general">
        
        <!-- Replace entire div with custom logic -->
        <xpath expr="//div[@id='o_survey_certification']" position="replace">
            <t t-if="user_input.survey_id.certificate_template_id and user_input.certification_report_image">
                <!-- CUSTOM CERTIFICATE -->
                <div class="article" t-att-data-oe-model="user_input._name" t-att-data-oe-id="user_input.id">
                    <div style="text-align: center; width: 100%;">
                        <img t-attf-src="data:image/png;base64,{{user_input.certification_report_image.decode('utf-8')}}" 
                             style="max-width: 100%; height: auto;"/>
                    </div>
                </div>
            </t>
            <t t-else="">
                <!-- DEFAULT CERTIFICATE (copy dari original) -->
                <div id="o_survey_certification" t-att-data-oe-model="user_input._name" t-att-data-oe-id="user_input.id"
                    t-attf-class="#{'article certification-wrapper ' + layout_template + ' ' + layout_color}">
                    <div class="certification">
                        <div class="certification-seal" t-if="user_input.scoring_success and layout_template == 'modern'"/>
                        <div class="certification-top">
                            <h1><b>Certificate</b>
                                <br/><span t-if="user_input.scoring_success">of achievement</span>
                            </h1>
                        </div>
                        <div class="page certification-content">
                            <div class="oe_structure"/>
                            <div t-if="user_input.scoring_success">
                            <div class="oe_structure"/>
                                <p> <span>This certificate is presented to</span>
                                    <br/>
                                    <t t-set="certif_style" t-value="''"/>
                                    <t t-set="certified_name" t-value="user_input.partner_id.name or user_input.email or ''"/>
                                    <t t-if="len(certified_name) > 35 and layout_template == 'classic'">
                                        <t t-set="certif_style" t-value="certif_style + 'font-size: 20px; line-height: 4; font-family: certification-serif;'"/>
                                    </t>
                                    <t t-elif="layout_template == 'modern'">
                                        <t t-if="len(certified_name) > 45">
                                            <t t-set="certif_style" t-value="certif_style + 'font-size: 20px; line-height: 4;'"/>
                                        </t>
                                        <t t-elif="len(certified_name) > 35">
                                            <t t-set="certif_style" t-value="certif_style + 'font-size: 30px; line-height: 4;'"/>
                                        </t>
                                        <t t-elif="len(certified_name) > 20">
                                            <t t-set="certif_style" t-value="certif_style + 'font-size: 40px; line-height: 4;'"/>
                                        </t>
                                    </t>
                                    <t t-else="">
                                        <t t-set="certif_style" t-value="certif_style + 'font-size: 30px; line-height: 4;'"/>
                                    </t>
                                    <span t-att-style="certif_style" class="user-name" t-out="certified_name">DEMO_CERTIFIED_NAME</span>
                                    <br/> <span>by</span> <span class="certification-company" t-field="user_input.create_uid.sudo().company_id.display_name">Odoo</span> <span>for successfully completing</span>
                                    <br/><b><span class="certification-name" t-field="user_input.survey_id.display_name">Functional Training</span></b>
                                 </p>
                                <div class="oe_structure"/>
                            </div>
                            <div t-else="" class="certification-failed">
                                <p>Certification Failed</p>
                                <div class="oe_structure"/>
                            </div>
                            <div class="oe_structure"/>
                        </div>
                    </div>
                </div>
            </t>
        </xpath>
        
    </template>

</odoo>
